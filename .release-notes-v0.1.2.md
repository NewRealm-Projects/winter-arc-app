# Winter Arc Tracker v0.1.2 - CI/CD Fixes & UI Modernization

## ðŸ”¥ Critical Fixes

### CI/CD Deployment Triggers
Fixed staging and production deployment workflows to trigger correctly on branch pushes:
- âœ… Staging now deploys automatically when pushing to `develop`
- âœ… Production now deploys automatically when pushing to `main`
- âœ… Fixed `workflow_run` trigger dependency to use workflow files from default branch
- âœ… Explicit branch checkouts in deployment workflows

### Firestore Security
- âœ… Fixed subcollection access rules for `checkins`, `trainingLoad`, and `entries`
- âœ… Added `waitForAuth()` guard to prevent race conditions on app startup

---

## âœ¨ Features

### Branch Naming Convention Enforcement
Automated validation system for consistent branch naming:
- **Pattern**: `<username>/<type>-<description>`
- **Types**: feature, fix, chore, refactor, docs, test, style
- **GitHub Actions Workflow** validates branch names on push/PR
- **Husky Pre-Push Hook** validates locally with helpful error messages

### Firestore Consistency Check
Comprehensive data validation script (`scripts/consistency-check.mjs`):
- Migration status validation (days â†’ entries)
- Streak calculation with weighted logic (70% threshold)
- Triple-storage synchronization (entries/checkins/trainingLoad)
- Schema validation, week aggregation accuracy
- JSON + log file export for detailed reports

### Unified Modal System
New `AppModal` component with:
- âœ… Consistent design across all modals
- âœ… Full accessibility (A11y) support - focus trap, escape key, ARIA
- âœ… Theme-aware (light/dark mode)
- âœ… Responsive sizing (sm/md/lg/xl)
- âœ… Z-index management system

### Training Load Revamp
- Activity tracking with check-in presets
- Live preview of training load calculation
- Wellness modifiers: sleep, recovery, sickness

---

## ðŸŽ¨ UI/UX Modernization

### Glassmorphism Removed
Replaced all `backdrop-blur` effects with solid opaque backgrounds:
- BottomNav now uses `bg-white dark:bg-gray-900`
- Toast notifications use opaque backgrounds
- Leaderboard stat cards theme-aware
- Consistent z-index system (`var(--z-overlay)`, `var(--z-modal)`)

### Layout & Spacing Fixes
- Fixed double padding in Layout.tsx causing bottom content clipping
- Increased bottom padding from `80px` to `128px` for better BottomNav clearance
- Updated all pages: Dashboard, Leaderboard, Notes, Settings, Onboarding, PushupTraining

---

## ðŸ§ª Testing

- E2E check-in flow tests (`tests/e2e/checkin.spec.ts`)
- Training load formula tests with wellness modifiers
- Auth-flow improvements with popup/redirect selection

---

## ðŸ”§ Technical

### React 19 + Vite 7 Upgrade
- Latest Firebase/Sentry stack
- `useActionState`/`useOptimistic` on Notes page for immediate feedback
- ESLint 9 compatibility (`eslint.config.js`)

### Sentry Telemetry
- Breadcrumbs for auth events, check-in saves, training load calculations
- `tracesSampleRate` increased to 0.2
- `allowUrls` filtering for cleaner error tracking

---

## ðŸ§¹ Maintenance

- Removed temporary files (`nul`, `tmp_pwa_prompt.tsx`)
- Archived old setup/report files
- Cleanup configuration (`cleanup.config.json`)
- ESLint configuration improved for build artifacts

---

## ðŸ“Š Deployment

**Production**: [app.winterarc.newrealm.de](https://app.winterarc.newrealm.de)
**Staging**: [staging.winterarc.newrealm.de](https://staging.winterarc.newrealm.de)

---

ðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)
